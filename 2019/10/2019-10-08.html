<p><span style="color: rgb(96, 96, 96);">JavaScript基本数据类型有5种：字符串、数字、布尔、null、undefined。 用户定义的类型（object）并没有类的声明，因此继承关系只能通过构造函数和原型链来检查。 本文要解决的问题，如何检查一个变量的类型？先给结论：</span></p><p><strong style="color: rgb(96, 96, 96);">如果你要判断的是基本数据类型或JavaScript内置对象，使用</strong><strong style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">toString</strong><strong style="color: rgb(96, 96, 96);">； 如果要判断的时自定义类型，请使用</strong><strong style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">instanceof</strong><span style="color: rgb(96, 96, 96);">。</span></p><p><span style="color: rgb(96, 96, 96);">不同的编程语言都有自己的方式来提供类型信息，例如C#的反射、</span><a href="http://harttle.com/2015/09/15/effective-cpp-47.html" target="_blank" style="color: rgb(77, 133, 209);">C++的Traits</a><span style="color: rgb(96, 96, 96);">， JavaScript提供类型信息的方式更加灵活，因而也容易产生很多误用。 下面来分析常见类型检查手段的区别：typeof, instanceof, constructor, toString。</span></p><p><span style="color: rgb(119, 119, 119);">如果你在寻找类型转换的解决方案，而非类型检查，请移步</span><a href="http://harttle.com/2015/08/21/js-type-conv.html" target="_blank" style="color: rgb(77, 133, 209);">JavaScript类型转换</a><span style="color: rgb(119, 119, 119);">。</span></p><p><span style="color: rgb(96, 96, 96);">typeof</span></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/typeof" target="_blank" style="color: rgb(77, 133, 209);">typeof</a><span style="color: rgb(96, 96, 96);">&nbsp;操作符返回的是类型字符串，它的返回值有6种取值：</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">typeof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(174, 129, 255);">3</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// "number"</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">typeof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(230, 219, 116);">"abc"</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// "string"</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">typeof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">{}</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// "object"</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">typeof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">true</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// "boolean"</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">typeof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">undefined</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// "undefined"</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">typeof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">function</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(){}</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// "function"</span></p><p><span style="color: rgb(96, 96, 96);">所有对象的</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">typeof</span><span style="color: rgb(96, 96, 96);">都是</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">"object"</span><span style="color: rgb(96, 96, 96);">，不能用于检测用户自定义类型。 比如</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Date</span><span style="color: rgb(96, 96, 96);">,&nbsp;</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">RegExp</span><span style="color: rgb(96, 96, 96);">,&nbsp;</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Array</span><span style="color: rgb(96, 96, 96);">,&nbsp;</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">DOM Element</span><span style="color: rgb(96, 96, 96);">的类型都是</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">"object"</span><span style="color: rgb(96, 96, 96);">：</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">typeof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">[]</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// "object"</span></p><p><span class="ql-font-monospace" style="background-color: rgb(248, 248, 248); color: rgb(186, 90, 93);">typeof</span><span style="color: rgb(96, 96, 96);">还有一个知名的bug：</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">typeof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">null</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp; </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// "object"</span></p><p><span class="ql-font-monospace" style="background-color: rgb(248, 248, 248); color: rgb(186, 90, 93);">null</span><span style="color: rgb(96, 96, 96);">是基本数据类型，它的类型显然是</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Null</span><span style="color: rgb(96, 96, 96);">。其实这也反映了</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">null</span><span style="color: rgb(96, 96, 96);">的语义， 它是一个空指针表示对象为空，而</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">undefined</span><span style="color: rgb(96, 96, 96);">才表示什么都没有。 总之，</span><strong style="color: rgb(96, 96, 96);">typeof只能用于基本数据类型检测，对于</strong><strong style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">null</strong><strong style="color: rgb(96, 96, 96);">还有Bug</strong><span style="color: rgb(96, 96, 96);">。</span></p><p><span style="color: rgb(96, 96, 96);">instanceof</span></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/instanceof" target="_blank" style="color: rgb(77, 133, 209);">instanceof</a><span style="color: rgb(96, 96, 96);">操作符用于检查某个对象的原型链是否包含某个构造函数的</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">prototype</span><span style="color: rgb(96, 96, 96);">属性。例如：</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">obj</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Widget</span></p><p><span class="ql-font-monospace" style="background-color: rgb(248, 248, 248); color: rgb(186, 90, 93);">obj</span><span style="color: rgb(96, 96, 96);">的原型链上有很多对象（成为隐式原型），比如：</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">obj.__proto__</span><span style="color: rgb(96, 96, 96);">,&nbsp;</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">obj.__proto__.__proto__</span><span style="color: rgb(96, 96, 96);">, …</span></p><p><span style="color: rgb(96, 96, 96);">如果这些对象里存在一个</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">p === Widget.prototype</span><span style="color: rgb(96, 96, 96);">，那么</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">instanceof</span><span style="color: rgb(96, 96, 96);">结果为</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">true</span><span style="color: rgb(96, 96, 96);">，否则为</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">false</span><span style="color: rgb(96, 96, 96);">。</span></p><p><span class="ql-font-monospace" style="background-color: rgb(248, 248, 248); color: rgb(186, 90, 93);">instanceof</span><span style="color: rgb(96, 96, 96);">是通过原型链来检查类型的，所以适用于任何”object”的类型检查。</span></p><p><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// 比如直接原型关系</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">function</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Animal</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(){</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">}</span></p><p><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Animal</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">)</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Animal</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp; </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><br></p><p><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// 原型链上的间接原型</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">function</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Cat</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(){}</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Cat</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">prototype</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">=</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Animal</span></p><p><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Cat</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">)</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Animal</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><span class="ql-font-monospace" style="background-color: rgb(248, 248, 248); color: rgb(186, 90, 93);">instanceof</span><span style="color: rgb(96, 96, 96);">也可以用来检测内置兑现，比如</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Array</span><span style="color: rgb(96, 96, 96);">,&nbsp;</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">RegExp</span><span style="color: rgb(96, 96, 96);">,&nbsp;</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Object</span><span style="color: rgb(96, 96, 96);">,&nbsp;</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Function</span><span style="color: rgb(96, 96, 96);">：</span></p><p><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">[</span><span class="ql-font-monospace" style="color: rgb(174, 129, 255);">1</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">,</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(174, 129, 255);">2</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">,</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(174, 129, 255);">3</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">]</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Array</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><span class="ql-font-monospace" style="color: rgb(230, 219, 116);">/abc/</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">RegExp</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">({})</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Object</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">function</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(){})</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Function</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><span class="ql-font-monospace" style="background-color: rgb(248, 248, 248); color: rgb(186, 90, 93);">instanceof</span><span style="color: rgb(96, 96, 96);">对基本数据类型不起作用，因为基本数据类型没有原型链。</span></p><p><span class="ql-font-monospace" style="color: rgb(174, 129, 255);">3</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Number</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// false</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">true</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Boolean</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// false</span></p><p><span class="ql-font-monospace" style="color: rgb(230, 219, 116);">'abc'</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">String</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// false</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">null</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">XXX</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp;</span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// always false</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">undefined</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">XXX</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp;</span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// always false</span></p><p><span style="color: rgb(96, 96, 96);">但你可以这样：</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Number(</span><span class="ql-font-monospace" style="color: rgb(174, 129, 255);">3</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">)</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Number</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Boolean(</span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">true</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">)</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Boolean</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">String(</span><span class="ql-font-monospace" style="color: rgb(230, 219, 116);">'abc'</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">)</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">String</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><span style="color: rgb(96, 96, 96);">但这时你已经知道数据类型了，类型检查已经没有意义了。</span></p><p><span style="color: rgb(96, 96, 96);">constructor</span></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/constructor" target="_blank" style="color: rgb(77, 133, 209);">constructor</a><span style="color: rgb(96, 96, 96);">属性返回一个指向创建了该对象原型的函数引用。需要注意的是，该属性的值是那个函数本身。例如：</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">function</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Animal</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(){}</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">var</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">a</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">=</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Animal</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">a</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">constructor</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">===</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Animal</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp;</span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><span class="ql-font-monospace" style="background-color: rgb(248, 248, 248); color: rgb(186, 90, 93);">constructor</span><span style="color: rgb(96, 96, 96);">不适合用来判断变量类型。首先因为它是一个属性，所以非常容易被伪造：</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">var</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">a</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">=</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Animal</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">a</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">constructor</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">===</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Array</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">a</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">constructor</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">===</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Animal</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp;</span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// false</span></p><p><span style="color: rgb(96, 96, 96);">另外</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">constructor</span><span style="color: rgb(96, 96, 96);">指向的是最初创建当前对象的函数，是原型链最上层的那个方法：</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">function</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Cat</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(){}</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Cat</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">prototype</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">=</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Animal</span></p><p><br></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">function</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">BadCat</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(){}</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">BadCat</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">prototype</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">=</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Cat</span></p><p><br></p><p><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">BadCat</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">).</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">constructor</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">===</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Animal</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Animal</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">constructor</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">===</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Function</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp; &nbsp; </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><span style="color: rgb(96, 96, 96);">与</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">instanceof</span><span style="color: rgb(96, 96, 96);">类似，</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">constructor</span><span style="color: rgb(96, 96, 96);">只能用于检测对象，对基本数据类型无能为力。 而且因为</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">constructor</span><span style="color: rgb(96, 96, 96);">是对象属性，在基本数据类型上调用会抛出</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">TypeError</span><span style="color: rgb(96, 96, 96);">异常：</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">null</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">constructor</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// TypeError!</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">undefined</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">constructor</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp;</span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// TypeError!</span></p><p><span style="color: rgb(96, 96, 96);">与</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">instanceof</span><span style="color: rgb(96, 96, 96);">不同的是，在访问基本数据类型的属性时，JavaScript会自动调用其构造函数来生成一个对象。例如：</span></p><p><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(174, 129, 255);">3</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">).</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">constructor</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">===</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Number</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">true</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">constructor</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">===</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Boolean</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><span class="ql-font-monospace" style="color: rgb(230, 219, 116);">'abc'</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">constructor</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">===</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">String</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// 相当于</span></p><p><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Number(</span><span class="ql-font-monospace" style="color: rgb(174, 129, 255);">3</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">)).</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">constructor</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">===</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Number</span></p><p><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Boolean(</span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">true</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">)).</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">constructor</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">===</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Boolean</span></p><p><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">String(</span><span class="ql-font-monospace" style="color: rgb(230, 219, 116);">'abc'</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">)).</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">constructor</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">===</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">String</span></p><p><span style="color: rgb(119, 119, 119);">这种将一个值类型转换为对象引用类型的机制在其他语言中也存在，在C#中称为</span><strong style="color: rgb(119, 119, 119);">装箱</strong><span style="color: rgb(119, 119, 119);">（Boxing）。</span></p><p><span style="color: rgb(96, 96, 96);">跨窗口问题</span></p><p><span style="color: rgb(96, 96, 96);">我们知道Javascript是运行在宿主环境下的，而每个宿主环境会提供一套ECMA标准的内置对象，以及宿主对象（如</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">window</span><span style="color: rgb(96, 96, 96);">,&nbsp;</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">document</span><span style="color: rgb(96, 96, 96);">），一个新的窗口即是一个新的宿主环境。 不同窗口下的内置对象是不同的实例，拥有不同的内存地址。</span></p><p><span style="color: rgb(96, 96, 96);">而</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">instanceof</span><span style="color: rgb(96, 96, 96);">和</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">constructor</span><span style="color: rgb(96, 96, 96);">都是通过比较两个</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Function</span><span style="color: rgb(96, 96, 96);">是否相等来进行类型判断的。 此时显然会出问题，例如：</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">var</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">iframe</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">=</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">document.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">createElement</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(230, 219, 116);">'iframe'</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">);</span></p><p><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">var</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">iWindow</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">=</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">iframe</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">contentWindow</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">;</span></p><p><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">document.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">body</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">appendChild</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">iframe</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">);</span></p><p><br></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">iWindow</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.Array</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">===</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Array</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// false</span></p><p><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// 相当于</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">iWindow</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.Array</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">===</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">window.Array</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp;</span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// false</span></p><p><span style="color: rgb(96, 96, 96);">因此</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">iWindow</span><span style="color: rgb(96, 96, 96);">中的数组</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">arr</span><span style="color: rgb(96, 96, 96);">原型链上是没有</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">window.Array</span><span style="color: rgb(96, 96, 96);">的。请看：</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">iWindow</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.document.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">write</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(230, 219, 116);">'&lt;script&gt; var arr = [1, 2]&lt;/script&gt;'</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">);</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">iWindow</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">arr</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Array</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// false</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">iWindow</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">arr</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">instanceof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">iWindow</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.Array</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp;</span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// true</span></p><p><span style="color: rgb(96, 96, 96);">toString</span></p><p><span class="ql-font-monospace" style="background-color: rgb(248, 248, 248); color: rgb(186, 90, 93);">toString</span><span style="color: rgb(96, 96, 96);">方法是最为可靠的类型检测手段，它会将当前对象转换为字符串并输出。&nbsp;</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">toString</span><span style="color: rgb(96, 96, 96);">属性定义在</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Object.prototype</span><span style="color: rgb(96, 96, 96);">上，因而所有对象都拥有</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">toString</span><span style="color: rgb(96, 96, 96);">方法。 但</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Array</span><span style="color: rgb(96, 96, 96);">,&nbsp;</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Date</span><span style="color: rgb(96, 96, 96);">等对象会重写从</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Object.prototype</span><span style="color: rgb(96, 96, 96);">继承来的</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">toString</span><span style="color: rgb(96, 96, 96);">， 所以最好用</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Object.prototype.toString</span><span style="color: rgb(96, 96, 96);">来检测类型。</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">toString</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">=</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Object.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">prototype</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">toString</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">;</span></p><p><br></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">toString</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">call</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">Date);</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp;</span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// [object Date]</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">toString</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">call</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">String);</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp;</span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// [object String]</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">toString</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">call</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(Math);</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// [object Math]</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">toString</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">call</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(174, 129, 255);">3</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">);</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// [object Number]</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">toString</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">call</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">([]);</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// [object Array]</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">toString</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">call</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">({});</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// [object Object]</span></p><p><br></p><p><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// Since JavaScript 1.8.5</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">toString</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">call</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">undefined</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">);</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// [object Undefined]</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">toString</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">call</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">null</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">);</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// [object Null]</span></p><p><span class="ql-font-monospace" style="background-color: rgb(248, 248, 248); color: rgb(186, 90, 93);">toString</span><span style="color: rgb(96, 96, 96);">也不是完美的，它无法检测用户自定义类型。 因为</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Object.prototype</span><span style="color: rgb(96, 96, 96);">是不知道用户会创造什么类型的， 它只能检测ECMA标准中的那些内置类型。</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">toString</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">.</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">call</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">new</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">Animal</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">)</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; </span><span class="ql-font-monospace" style="color: rgb(117, 113, 94);">// [object Object]</span></p><p><span style="color: rgb(96, 96, 96);">因为返回值是字符串，也避免了跨窗口问题。当然IE弹窗中还是有Bug，不必管它了。 现在多少人还在用IE？多少人还在用弹窗？</span></p><p><span style="color: rgb(96, 96, 96);">和</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Object.prototype.toString</span><span style="color: rgb(96, 96, 96);">类似地，</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Function.prototype.toString</span><span style="color: rgb(96, 96, 96);">也有类似功能， 不过它的</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">this</span><span style="color: rgb(96, 96, 96);">只能是</span><span style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">Function</span><span style="color: rgb(96, 96, 96);">，其他类型（例如基本数据类型）都会抛出异常。</span></p><p><span style="color: rgb(96, 96, 96);">总结</span></p><ul><li><span style="background-color: rgb(248, 248, 248);">typeof</span><span style="color: rgb(96, 96, 96);">只能检测基本数据类型，对于</span><span style="background-color: rgb(248, 248, 248);">null</span><span style="color: rgb(96, 96, 96);">还有Bug；</span></li><li><span style="background-color: rgb(248, 248, 248);">instanceof</span><span style="color: rgb(96, 96, 96);">适用于检测对象，它是基于原型链运作的；</span></li><li><span style="background-color: rgb(248, 248, 248);">constructor</span><span style="color: rgb(96, 96, 96);">指向的是最初创建者，而且容易伪造，不适合做类型判断；</span></li><li><span style="background-color: rgb(248, 248, 248);">toString</span><span style="color: rgb(96, 96, 96);">适用于ECMA内置JavaScript类型（包括基本数据类型和内置对象）的类型判断；</span></li><li>基于引用判等的类型检查都有跨窗口问题，比如<span class="ql-font-monospace" style="background-color: rgb(248, 248, 248); color: rgb(186, 90, 93);">instanceof</span>和<span class="ql-font-monospace" style="background-color: rgb(248, 248, 248); color: rgb(186, 90, 93);">constructor</span>。</li></ul><p><strong style="color: rgb(96, 96, 96);">总之，如果你要判断的是基本数据类型或JavaScript内置对象，使用</strong><strong style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">toString</strong><strong style="color: rgb(96, 96, 96);">； 如果要判断的时自定义类型，请使用</strong><strong style="color: rgb(186, 90, 93); background-color: rgb(248, 248, 248);" class="ql-font-monospace">instanceof</strong><span style="color: rgb(96, 96, 96);">。</span></p><p><span style="color: rgb(96, 96, 96);">有时Duck Typing的方式也非常可行，貌似已经成为了前端的惯例。 比如jQuery是这样判断一个Window的：</span></p><p><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">isWindow</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);">: </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">function</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">(</span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">obj</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">){</span></p><p><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> &nbsp; &nbsp;</span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">return</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">obj</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">&amp;&amp;</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">typeof</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">obj</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">===</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(230, 219, 116);">'object'</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(249, 38, 114);">&amp;&amp;</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(230, 219, 116);">"setInterval"</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(102, 217, 239);">in</span><span class="ql-font-monospace" style="color: rgb(255, 255, 255);"> </span><span class="ql-font-monospace" style="color: rgb(166, 226, 46);">obj</span><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">;</span></p><p><span class="ql-font-monospace" style="color: rgb(248, 248, 242);">}</span></p><p><span style="color: rgb(96, 96, 96);">另外DOM Element的类型检测也可以通过上述的方法来完成，但没有一种方法在任何浏览器上都可行。 DOM Element的类型检测可以参见这篇文章： http://tobyho.com/2011/01/28/checking-types-in-javascript/</span></p><attachment contenteditable="false" data-atts="%5B%5D" data-aid=".atts-8f2e6015-c5b0-4c0e-bb09-d3c3118a28a5"></attachment><p><br></p>